<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>Assignment 1</title>
        <script type="text/javascript" src="./d3.js"></script>
        <style>
            body {
               width: 100%;
               display: flex;
               justify-content: center;
               flex-direction: row;
               line-height: 150%;
            }

            a {
              color: #0F6F9F;
              text-decoration: none;
            }

            a:hover {
              color: red;
            }

            .body-content {
              max-width: 800px;
            }

            .assignment-header {
              color: #0d8291;
              font-size: 450%;
            }

            .part-header {
              font-size: 250%;
              color: #0d8291;
              text-decoration: underline;
            }

            .scroll-nav {
              cursor: pointer;
              color: blue;
              text-decoration: underline;
            }

            .thin-line {
              width: 100%;
              height: 1px;
              background-color: black;
            }

            .thick-line {
              width: 100%;
              height: 4px;
              background-color: black;
            }

            .small_text {
              font-size: 78%;
            }

            #part3-chart {
              /*border-style: solid;*/
            }

            .part3-chart-container {
              display: flex;
              flex-direction: row;
              align-items: center;
              margin: 10px;
              padding-left: 10px;
              border-style: double;
              border-width: 3px;
              border-color: black;
            }

            .part4-chart-container {
              display: flex;
              flex-direction: row;
              align-items: center;
            }

            .chart-option {
              cursor: pointer;
              color: black !important;
            }

            .option-fresh-fruit {
              color: #ff2419;
              list-style-type: square;
            }

            .option-fresh-vegetable {
              color: #018215;
              list-style-type: square;
            }

            .option-storage-fruit {
              color: #ff9397;
              list-style-type: square;
            }

            .option-both {
              color: purple;
              list-style-type: square;
            }

            .option-men {
              color: red;
              list-style-type: square;
            }

            .option-women {
              color: blue;
              list-style-type: square;
            }

            .option-storage-vegetable {
              color: #dae4c3;
              list-style-type: square;
            }

            .grid{ /* styling for the grid lines */
/*
                stroke: red;
                opacity: 0.7;
                */
                stroke: #25b898;
                color: green;
                background-color: green;
                stroke: red;
            }
            .grid path { /* styling for the grid lines */
              stroke-width: 0; /* to make the axis not thicker */
            }

            div.bar {
                display: inline-block;
                width: 20px;
                height: 75px; /* We'll override height later */
                background-color: teal;
                margin-right: 2px;
            }

            .part1-question_text li {
              color: gray;
              font-style: italic;
              margin-bottom: -18px;
              margin-top: 45px;
            }

        </style>
    </head>
    <body>
        <div class="body-content">
          <h1 class="assignment-header">Assignment 1</h1>

          <p>
            Here you can scroll to specific part of the assignment:
          </p>
          <ol>
            <li class="scroll-nav" id="scroll1">Part1</li>
            <li class="scroll-nav" id="scroll2">Part2</li>
            <li class="scroll-nav" id="scroll3">Part3</li>
            <li class="scroll-nav" id="scroll4">Part4</li>
          </ol>

<!-- ########################  PART 1  ####################### -->
          <br />
          <br />
          <h2 class="part-header" id="part1">Part 1: DAOST Chapter 2 Questions</h2>

          <ul class="part1-question_text">
            <li>Explain in your own words the point of the jitter plot.</li>
              <p>The point of a jitter plot is to get a better idea of the frequency of data points in
                a dot plot.
                E.g. you have a dot plot and many data points have the same value, therefore
                they are drawn onto the same point. When making a small jitter to each data point you can
                better see how the data is distributed.<br/>

              </p>

            <li>Explain in your own words the point of figure 2-3.</li>
              <img src="image23.png" alt="Image 2-3" style="width:210px;" align="right">
              <p>In figure 2.3. the author is explaining the importance of choosing the right bin alignment
                and pointing out that for the same data it clearly matters how you choose the bin alignment
                as it changes the visualisation and interpretation of the data (you can tweek the bin alignment
                for a half a bin width in both directions as is shown in image 2-3). Because of this, histograms
                can be sometimes indefinite. Also they can sometimes be a poor method to determine distribution’s shape as
                they are really affected by the number of used bins. <i style="font-size: 12px;">(Image 2.3. from Data Analysis with Open Source Tools by Philipp K. Janert).</i> </p>

            <li>The author of DAOST (Philipp Janert) likes KDEs (and think they're better than histograms). And I don't. When can KDEs be misleading?</li>
              <p>When you want to know exactly the amount of certain points(or points within a bin) you can’t see what the right amount is.
                It is harder to get a specific information from the KDE plots then from histograms</p>

            </ul>


          <!-- ########################  PART 2  ####################### -->
          <br />
          <br />
          <h2 class="part-header" id="part2">Part 2: DAOST Chapter 3 Questions</h2>
          <p>
            ...
          </p>


          <!-- ########################  PART 3  ####################### -->
          <br />
          <br />
          <h2 class="part-header" id="part3">Part 3: Viz 1</h2>
          <p>
            <i>This is a reproduction of http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the</i>
          </p>
          <br/>

          <div>
            <div class="thin-line"/>
    				<p  class="small_text">
              Quantitative Analysis of NYC Open Data: Every data set that the city releases tells a story. This blog is all about telling those stories, one data set at a time.&nbsp;&nbsp;
            </p>

            <a href="/about" class="small_text">About Me</a>&nbsp;&nbsp;
            <a href="/aboutyou" class="small_text">About You</a>&nbsp;&nbsp;
            <a href="/interviews" class="small_text">Interviews</a>&nbsp;&nbsp;
            <a href="/press" class="small_text">Press</a>&nbsp;&nbsp;
            <a href="/topics" class="small_text">Topics</a>&nbsp;&nbsp;
            <a href="/subscribe" class="small_text">Subscribe</a>&nbsp;&nbsp;
            <div class="thick-line"/>
    			</div>

          <div id="newDay">

          <br/>

          <div class="date">
            <b style="font-size: 80%">September 18, 2015</b>
          </div>

          <div class="post">
            <a href="http://iquantny.tumblr.com/post/129373499164/this-is-quantifiably-the-best-month-to-go-to-the" style="color:black; text-decoration:none;font-size:180%;line-height:130%;"><h2 style="font-style:bolder;">This is Quantifiably the Best Month to go to the Farmers Market</h2></a>
            <p></p><p>As part of a homework assignment, I ask my students at Pratt to go out and chart something of interest to them, and <a href="https://t.umblr.com/redirect?z=https%3A%2F%2Fwww.linkedin.com%2Fin%2Fkvsavarese&amp;t=NmE2YmYyYjU4NTI3MTFhYWFiMWE1ZjFhNzc1NmUzMmE0ZDQ4OGM2NSwxeHM2a1phNg%3D%3D&amp;b=t%3A5jlxwUw4OZ-2SbgNDPgKMQ&amp;p=http%3A%2F%2Fiquantny.tumblr.com%2Fpost%2F129373499164%2Fthis-is-quantifiably-the-best-month-to-go-to-the&amp;m=1">Katherine Savarese</a> came back with a simple chart about farmers markets that I loved- it inspired this post.</p><p>You probably know that farmers markets are a staple across <a href="https://t.umblr.com/redirect?z=http%3A%2F%2Fwww.grownyc.org%2Ffiles%2Fgmkt%2Fmap.pdf&amp;t=MGM4YmRjZjQ2ZmFmYzBiYmMzMmY5NDU2MTdiNzMzMmYyOWQ5YjQ2ZSwxeHM2a1phNg%3D%3D&amp;b=t%3A5jlxwUw4OZ-2SbgNDPgKMQ&amp;p=http%3A%2F%2Fiquantny.tumblr.com%2Fpost%2F129373499164%2Fthis-is-quantifiably-the-best-month-to-go-to-the&amp;m=1">all five boroughs</a> of New York City, but September happens to be a very special month.  Why is that? &nbsp;Well, it turns out September is the month with the most unique types of fresh produce- forty three to be exact.</p><p>To show the current offerings, we charted how many types of fruits and vegetables are available by month, and showed if they were fresh or from storage.&nbsp;</p>
            <div class="part3-chart-container">
              <div id="part3-chart">

              </div>
              <ul>
                <li onclick="updateChartBar(0)" class="option-fresh-fruit"><span class="chart-option">Fresh Fruit</span></li>
                <li onclick="updateChartBar(2)" class="option-fresh-vegetable"><span class="chart-option">Fresh Vegetable</span></li>
                <li onclick="updateChartBar(1)" class="option-storage-fruit"><span class="chart-option">Storage Fruit</span></li>
                <li onclick="updateChartBar(3)" class="option-storage-vegetable"><span class="chart-option">Storage Vegetable</span></li>
              </ul>
            </div>

            <p>If you miss the month of September, you might be behind the fruit curve, but there are plenty more months of vegetables left. &nbsp;The chart shows that fresh vegetables are available 9 out of 12 months, but fruit is only available 5 out of 12. Now if only we could quantify how delicious the produce is…&nbsp;</p><p>—–</p><p>Data from:&nbsp;
            <a href="https://t.umblr.com/redirect?z=http%3A%2F%2Fwww.grownyc.org%2Fgreenmarket%2Fwhatsavailable&amp;t=MWU3YTNhNmYwMDJkNWUwNWQzOTUwMTZjMzJlMGNhM2E3YzdlNTIxMCwxeHM2a1phNg%3D%3D&amp;b=t%3A5jlxwUw4OZ-2SbgNDPgKMQ&amp;p=http%3A%2F%2Fiquantny.tumblr.com%2Fpost%2F129373499164%2Fthis-is-quantifiably-the-best-month-to-go-to-the&amp;m=1">http://www.grownyc.org/greenmarket/whatsavailable</a></p><p></p>



          <!-- ########################  PART 4  ####################### -->
          <br />
          <br />
          <h2 class="part-header" id="part4">Part 4: Viz 2</h2>
          <p>
            The following plot graph is recreation of the figur 3-5 in DAOST, but with data from the Boston Marathon winning times.
            As a default you see both the winning times for men and women, but you can easily chose to only see men or only women
            by clicking the legends.
          </p>

          <div class="part4-chart-container">
            <div id="marathon_graph">

            </div>
            <ul>
              <li onclick="updateMarathonChart('both')" class="option-both"><span class="chart-option">Both</span></li>
              <li onclick="updateMarathonChart('men')" class="option-men"><span class="chart-option">Men</span></li>
              <li onclick="updateMarathonChart('women')" class="option-women"><span class="chart-option">Women</span></li>
            </ul>
          </div>
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
          <br />
        </div>


        <script type="text/javascript">


          /**********************************
          ********** SCROLL LOGIC ***********
          ***********************************/

          document.getElementById("scroll1").onclick = function() {
            var elmnt = document.getElementById("part1");
            elmnt.scrollIntoView();
          };

          document.getElementById("scroll2").onclick = function() {
            var elmnt = document.getElementById("part2");
            elmnt.scrollIntoView();
          };

          document.getElementById("scroll3").onclick = function() {
            var elmnt = document.getElementById("part3");
            elmnt.scrollIntoView();
          };

          document.getElementById("scroll4").onclick = function() {
            var elmnt = document.getElementById("part4");
            elmnt.scrollIntoView();
          };



          /****************************
          ********** PART 3 ***********
          *****************************/


          // Lets start creating some helper functions
          var getBarFillColor = function (foodProduceIndexSelected) {

            if (foodProduceIndexSelected === 0) {
              return "#ff2419";
            } else if (foodProduceIndexSelected === 2) {
              return "#018215";
            } else if (foodProduceIndexSelected === 1) {
              return "#ff9397";
            } else if (foodProduceIndexSelected === 3) {
              return "#dae4c3";
            }
          }

          var getSubDataset = function (datasetWithAllTypes, foodProduceIndex) {
            var dataset = [];
            for (var i = 0; i < datasetWithAllTypes.length; i++) {
              var entry = datasetWithAllTypes[i];
              if (entry.Index === foodProduceIndex) {
                dataset.push(entry)
              }
            }

            return dataset;
          }

          function make_y_axis(scale, svg) {
            return d3.axisLeft()
                      .scale(scale)
                      .ticks(5);
          }



          // Next we declare some usefule variables
          var months = ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
          var w = 480;
          var h = 350;
          var datasetWithAllTypes; // the whole dataset with all the sub datasets i.e. fresh fruit, ...
          var foodProduceIndexSelected = 0; // we always picked fresh fruit sub dataset as default
          var xScale, yScale, svg, xAxis, yAxis;
          var padding = 40;

          var rowConverter = function(d) {
            return {
              Index: parseInt(d.Index),
              Month: d.Month,
              Count: parseInt(d.Count),
            };
          }

          // we load the data and display the bar chart
          d3.csv("green_market.csv", rowConverter, function(data) {

            // pick correct dataset
            datasetWithAllTypes = data;
            var dataset = getSubDataset(datasetWithAllTypes, foodProduceIndexSelected);

            // lets create the scales
            xScale = d3.scaleBand()
              .domain(months)
              .rangeRound([padding, w])  // 'rangeRound' enables rounding
              .paddingInner(0.6);

            yScale = d3.scaleLinear()
              .domain([0, d3.max(dataset, function(d) { return d.Count; })])
              .range([h - padding, padding * 2]); // double padding on the top to have room for title

            //Create SVG element
            svg = d3.select("#part3-chart")
                    .append("svg")
                    .attr("width", w)
                    .attr("height", h);

            // Setting chart lines (really long ticks)
            svg.append("g")
               .style("stroke", "#25b898")
               .style("color", "#25b898")
               .attr("class", "grid")
               .call(make_y_axis(yScale, svg)
                      .tickSize(-w, 0, 0)
                      .tickFormat("")
               )
               .attr("transform", "translate(" + padding + ",0)")
               .style("stroke", "#25b898")
               .style("color", "#25b898")
               ;

            //Create bars
            svg.selectAll("rect")
               .data(dataset)
               .enter()
               .append("rect")
               .attr("x", function(d, i) {
                  return xScale(d.Month);  // Setting x values
               })
               .attr("y", function(d) {
                  return yScale(d.Count);
               })
               .attr("width", xScale.bandwidth())
               .attr("height", function(d) {
                  return h - yScale(d.Count) - padding;
               })
               .attr("fill", function(d) {
                  return getBarFillColor(foodProduceIndexSelected);
               });

             // Define X axis
             xAxis = d3.axisBottom()
                 .scale(xScale)
                 .tickValues(months);

             //Define Y axis
             yAxis = d3.axisLeft()
                       .scale(yScale)
                       .ticks(5);

             //Create X axis
             svg.append("g")
                .attr("class", "x axis")
                .attr("transform", "translate(0," + (h - padding) + ")")
                .call(xAxis);

             //Create Y axis
             svg.append("g")
               .attr("class", "y axis")
               .attr("transform", "translate(" + padding + ",0)")
               .call(yAxis);

             // Setting y label
             svg.append("text")
                .attr("transform", "rotate(-90)")
                .attr("y", 0)
                .attr("x",0 - (h / 2))
                .attr("dy", "1em")
                .style("text-anchor", "middle")
                .style("font-weight", "bolder")
                .style("font-size", "10px")
                .text("# of Unique Kinds of Produce");

             // Setting the title
             svg.append("text")
                .attr("x", w / 2)
                .attr("y", padding) // we want little bit of padding from the top
                .attr("text-anchor", "middle")
                .style("font-size", "19px")
                .style("font-weight", "bolder")
                .text("NYC Green Market - Unique Produce Types");
        });


          // Defining the update functions which is called when produce type is clicked
          var updateChartBar = function(foodProduceIndexSelected) {
            // getting chosed sub dataset
            var dataset = getSubDataset(datasetWithAllTypes, foodProduceIndexSelected);

            // update y scale and y axis (we don't need to update x scale and axis, it is always the same)
            yScale.domain([0, d3.max(dataset, function(d) { return d.Count; })]);


            // updating all bars
            svg.selectAll("rect")
               .data(dataset)
               .transition()
               .duration(1000)
               .attr("x", function(d, i) {
                  return xScale(d.Month);  // Setting x values
               })
               .attr("y", function(d) {
                  return yScale(d.Count);
               })
               .attr("width", xScale.bandwidth())
               .attr("height", function(d) {
                  return h - yScale(d.Count) - padding;
               })
               .attr("fill", function(d) {
                   return getBarFillColor(foodProduceIndexSelected);
               });


            //Update X axis
   					svg.select(".x.axis")
   				    	.transition()
   				    	.duration(1000)
   						  .call(xAxis);

   					//Update Y axis
   					svg.select(".y.axis")
   				    	.transition()
   				    	.duration(1000)
   						  .call(yAxis);
          }


          /****************************
          ********** PART 4 ***********
          *****************************/

          // converter for our men data
          var marathonRowConverterMen = function(d) {
            var hours = parseInt(d.Time.substring(0,1));
            var minutes = parseInt(d.Time.substring(2,4));
            var totalMinutes = hours * 60 + minutes;
            return {
              Year: parseInt(d.Year),
              Athlete: d.Athlete,
              CountryState: d.CountryState,
              Time: totalMinutes,
              Notes: d.Notes,
              Gender: "Man",
            };
          }
          // converter for our women data
          var marathonRowConverterWomen = function(d) {
            var hours = parseInt(d.Time.substring(0,1));
            var minutes = parseInt(d.Time.substring(2,4));
            var totalMinutes = hours * 60 + minutes;
            return {
              Year: parseInt(d.Year),
              Athlete: d.Athlete,
              CountryState: d.CountryState,
              Time: totalMinutes,
              Notes: d.Notes,
              Gender: "Woman",
            };
          }

          // variables to store our data
          var menData = null; // the men dataset
          var womenData = null; // the women dataset
          var marathonDataset = null; // the selected (visible) dataset (men or women or both)

          // other useful variables which we will use later on
          var symbol = d3.symbol()
                         .size(10);
          var wMarathon = 700; // width of the scatterplot
          var hMarathon = 550; // height of the scatterplot
          var paddingMarathon = 50;
          var xScaleMarathon, yScaleMarathon, xAxisMarathon, yAxisMarathon, svgMarathon, line;

          // load the marathon data
          d3.csv("marathon_men.csv", marathonRowConverterMen, function(data) {
            menData = data;
            onMarathonDataLoaded();
          });

          d3.csv("marathon_women.csv", marathonRowConverterWomen, function(data) {
            womenData = data;
            onMarathonDataLoaded();
          });

          // the function that is called when all data is loaded
          var onMarathonDataLoaded = function() {
            // first we check if all the data has been loaded, if not, we return
            if (!menData ||! womenData) return;

            // our default selected dataset are both men and women
            var dataset = womenData.concat(menData);

            //Setting the scales
            xScaleMarathon = d3.scaleLinear()
                           .domain([d3.min(dataset, function(d) { return d.Year;}) - 5,
                                    d3.max(dataset, function(d) { return d.Year;}) + 5]) // -5 andd +5 to make little bit spacing
                           .range([paddingMarathon, wMarathon - paddingMarathon]);

            yScaleMarathon = d3.scaleLinear()
                           .domain([d3.min(dataset, function(d) { return d.Time;}) - 5,
                                    d3.max(dataset, function(d) { return d.Time;}) + 5]) // -5 andd +5 to make little bit spacing
                           .range([hMarathon - paddingMarathon, paddingMarathon]);

            //create an empty DOM
            svgMarathon = d3.select("#marathon_graph")
                            .append("svg")
                            .attr("width", wMarathon)
                            .attr("height", hMarathon);

            //creating the axis thing
            xAxisMarathon = d3.axisBottom(xScaleMarathon)
                          .ticks(5);

            //Define Y axis
            yAxisMarathon = d3.axisLeft()
                          .scale(yScaleMarathon)
                          .ticks(5);

            //Create X axis
            svgMarathon.append("g")
               .attr("class", "xMarathon axisMarathon")
               .attr("transform", "translate(0," + (hMarathon - paddingMarathon) + ")")
               .call(xAxisMarathon);

            //Create Y axis
            svgMarathon.append("g")
              .attr("class", "yMarathon axisMarathon")
              .attr("transform", "translate(" + paddingMarathon + ",0)")
              .call(yAxisMarathon);

            //Define line generator
    				line = d3.line()
    							.x(function(d) { return xScaleMarathon(d.Year); })
    							.y(function(d) { return yScaleMarathon(d.Time); });

            //Create line for womanData
            svgMarathon.append("path")
              .datum(womenData)
              .attr("class", "line women-line")
              .attr("d", line)
              .attr("fill", "none")
              .attr("stroke", "black")
              .attr("stroke-dasharray", "2");


            //Create line for menData
            svgMarathon.append("path")
              .datum(menData)
              .attr("class", "line men-line")
              .attr("d", line)
              .attr("fill", "none")
              .attr("stroke", "black")
              .attr("stroke-dasharray", "2");


            // creating the dots (the symbols)
            var dots = svgMarathon.selectAll(".dots")
            	.data(dataset)
            	.enter()
            	.append("path");

            dots.attr("d", symbol.type(function(d){
                  if(d.Gender === "Man"){
                    return d3.symbolDiamond
                  } else {
                    return d3.symbolCircle
                }}))
              	.attr('stroke-width', 0.4)
                .attr("stroke", function(d) {
                  if(d.Gender === "Man"){ return "red"} else { return "blue"}
                })
                .attr("fill", "#00000000")

                .attr("class", "marathon-dots")
              	.attr('transform',function(d){ return "translate("+xScaleMarathon(d.Year)+","+yScaleMarathon(d.Time)+")"; })
                .on("mouseover", function(d) {
                  var xPosition = xScaleMarathon(d.Year) ; //+ xScale.bandwidth() / 2;
                  var yPosition = yScaleMarathon(d.Time) ; //+ 14;

                  //Create the tooltip label
                  svgMarathon.append("text")
                    .attr("id", "tooltip")
                    .attr("x", xPosition)
                    .attr("y", yPosition)
                    .attr("text-anchor", "middle")
                    .attr("font-family", "sans-serif")
                    .attr("font-size", "11px")
                    .attr("font-weight", "bold")
                    .attr("fill", "black")
                    .text(d.Athlete + ": " + d.Year + " on " + d.Time + " minutes");

                })
                .on("mouseout", function() {
                    d3.select("#tooltip").remove(); //Remove the tooltip
                });



            // Setting y label
            svgMarathon.append("text")
               .attr("transform", "rotate(-90)")
               .attr("y", 0)
               .attr("x",0 - (hMarathon / 2))
               .attr("dy", "1em")
               .style("text-anchor", "middle")
               .style("font-weight", "bolder")
               .style("font-size", "13px")
               .text("Minutes");

           // Setting x label
           svgMarathon.append("text")
              .attr("y", hMarathon - 25)
              .attr("x", (wMarathon / 2))
              .attr("dy", "1em")
              .style("text-anchor", "middle")
              .style("font-weight", "bolder")
              .style("font-size", "13px")
              .text("Year");

            // Setting the title
            svgMarathon.append("text")
               .attr("x", wMarathon / 2)
               .attr("y", paddingMarathon / 2) // we want little bit of padding from the top
               .attr("text-anchor", "middle")
               .style("font-size", "19px")
               .style("font-weight", "bolder")
               .text("Boston Marathon winning times");
          }

          // Defining the update functions for marathon plot which is called when legend is changed
          var updateMarathonChart = function(legend) {
            // getting chosed sub dataset
            var dataset;
            if (legend === 'both') {
              dataset = womenData.concat(menData);
            } else if (legend === 'men') {
              dataset = menData;
            } else if (legend === 'women') {
              dataset = womenData;
            } else {
              console.log("WARNING! THE LEGEND, " + legend + " , IS NOT SUPPORTED");
            }

            // update the scales
            xScaleMarathon.domain([d3.min(dataset, function(d) { return d.Year;}) - 5,
                                    d3.max(dataset, function(d) { return d.Year;}) + 5]); // -5 andd +5 to make little bit spacing

            yScaleMarathon.domain([d3.min(dataset, function(d) { return d.Time;}) - 5,
                                    d3.max(dataset, function(d) { return d.Time;}) + 5]); // -5 andd +5 to make little bit spacing


            // updating the dots (symbols)
            var dots = svgMarathon.selectAll(".marathon-dots")
              .data(dataset)
              .transition()
              .duration(1000);

            dots.attr("d", symbol.type(function(d){
                  if(d.Gender === "Man"){
                    return d3.symbolDiamond
                  } else {
                    return d3.symbolCircle
                }}))
                .attr('stroke-width', 0.4)
                .attr("stroke", function(d) {
                  if(d.Gender === "Man"){ return "red"} else { return "blue"}
                })
                .attr("fill", "#00000000")
                .attr('transform',function(d){ return "translate("+xScaleMarathon(d.Year)+","+yScaleMarathon(d.Time)+")"; });

            // update the line generator according to the new scale
            line = d3.line()
                  .x(function(d) { return xScaleMarathon(d.Year); })
                  .y(function(d) { return yScaleMarathon(d.Time); });

            // to update the lines with the new dataset we have to remove data from the original dataset
            var lineMenData = menData;
            var lineWomenData = womenData;
            if (legend === 'men') {
              lineWomenData = []; // no women data as we only want to show men data
            } else if (legend === 'women') {
              lineMenData = []; // no men data as we only want to show women data
            }

            // update lines for women and men data
            svgMarathon.select(".women-line")
              .datum(lineWomenData)
              .attr("d", line);

            svgMarathon.select(".men-line")
              .datum(lineMenData)
              .attr("d", line);


            //Update X axis
            svgMarathon.select(".xMarathon.axisMarathon")
                .transition()
                .duration(1000)
                .call(xAxisMarathon);

            //Update Y axis
            svgMarathon.select(".yMarathon.axisMarathon")
                .transition()
                .duration(1000)
                .call(yAxisMarathon);
          }


        </script>
    </body>
</html>
